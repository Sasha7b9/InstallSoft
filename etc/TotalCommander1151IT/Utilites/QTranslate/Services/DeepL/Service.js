function serviceHeader(){return new ServiceHeader(31,"DeepL","DeepL trains artificial intelligence to understand and translate texts."+Const.NL2+"https://www.deepl.com",Capability.TRANSLATE|Capability.DETECT_LANGUAGE)}function serviceHost(e,t,n){return"https://www2.deepl.com"}function serviceLink(e,t,n){var r="https://www.deepl.com/translator";return e&&isLanguage(t)&&isLanguage(n)&&(r+=format("#{0}/{1}/{2}",codeFromLanguage(t).toLowerCase(),codeFromLanguage(n).toLowerCase(),encodeGetParam(e))),r}function parseText(e){var t,n,r=/^\s+|(?:\s*\n)+\s*|[.!?\":;\u0964](?:\s+)|\s+$/g,a=[],s=0;for(e=prepareSource(e),e=limitSource(e);null!==(t=r.exec(e));){n=t[0];var u=/[.!?\":;\u0964](?:\s+)/.test(n);s<t.index&&(t=e.substr(s,t.index+(u?1:0)-s),a.push({type:1,text:t}),s+=t.length),a.push({type:0,text:u?n.slice(1):n}),s+=n.length-(u?1:0)}return s<e.length&&a.push({type:1,text:e.substr(s,e.length-s)}),a}function splitText(e){return parseText(e).filter(function(e){return 1===e.type}).map(function(e){return e.text.replace(/\s+/g," ")})}function getSourceLanguage(e,t){return e&&e.result&&e.result[t]?languageFromCode(e.result[t]):UNKNOWN_LANGUAGE}function serviceDetectLanguageRequest(e){return e=limitSource(e),new RequestData(HttpMethod.POST,"/jsonrpc",stringifyJSON({id:1,jsonrpc:"2.0",method:"LMT_split_into_sentences",params:{texts:[e],lang:{lang_user_selected:"auto",user_preferred_langs:["EN"]}}}),postHeader(!0))}function serviceDetectLanguageResponse(e){return getSourceLanguage(e=parseJSON(e),"lang")}function serviceTranslateRequest(e,t,n){e=splitText(e),t=codeFromLanguage(t),n=codeFromLanguage(n),e=e.map(function(e){return{kind:"default",raw_en_sentence:e}});var r=1;e.forEach(function(e){r+=((e.raw_en_sentence||"").match(/[i]/g)||[]).length});var a=(new Date).getTime();return t={id:2,jsonrpc:"2.0",method:"LMT_handle_jobs",params:{jobs:e,lang:{user_preferred_langs:[isLanguage(t)?t:"EN",n],source_lang_user_selected:t,target_lang:n},priority:1,timestamp:a+(r-a%r)}},new RequestData(HttpMethod.POST,"/jsonrpc",stringifyJSON(t),postHeader(!0))}function serviceTranslateResponse(e,t,n,r){t=parseJSON(t);var a="";if(t&&t.result&&t.result.translations){var s=t.result.translations.map(function(e){return e.beams&&0<e.beams.length?e.beams[0].postprocessed_sentence:""});parseText(e).forEach(function(e){a=0===e.type?a+e.text:a+s.shift()}),isLanguage(n)||(n=getSourceLanguage(t,"source_lang"))}return new ResponseData(a,n,r,"")}SupportedLanguages=[-1,"auto",-1,-1,-1,-1,-1,-1,-1,"BG",-1,"ZH",-1,-1,"CS","DA","NL","EN","ET","FI",-1,"FR",-1,"DE","EL",-1,-1,-1,"HU",-1,"id","IT",-1,"JA",-1,"KO","LV","LT",-1,-1,-1,"NB",-1,"PL","PT","RO","RU",-1,"SK","SL","ES",-1,"SV",-1,"TR","uk",-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];